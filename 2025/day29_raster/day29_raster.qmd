---
title: 'Raster'
subtitle: 'Welcome to #30DayMapChallenge 2025 day 29'
date: '2025-11-29'
image: 'day29_raster.png'
image-alt: ''
description: ''
output: html_document
execute: 
   eval: false
---

## Overview

```{r}
library(elevatr)
library(terra)
library(sf)
library(ggplot2)

# Define bounding box as sf polygon with CRS
bbox <- st_as_sf(st_as_sfc(st_bbox(c(
  xmin = 13.45,
  xmax = 13.75,
  ymin = 42.4,
  ymax = 42.6
), crs = 4326)))

# Download elevation data (clip to bbox)
dem <- get_elev_raster(
  locations = bbox,
  z = 10,
  clip = "bbox"
)

# Convert to terra object
dem_t <- rast(dem)

# Create hillshade for visual effect
hillshade <- shade(terrain(dem_t, "slope"), 
                   terrain(dem_t, "aspect"))

# Plot with ggplot
df <- as.data.frame(dem_t, xy = TRUE)
names(df)[3] <- "elevation"

ggplot(df) +
  geom_raster(aes(x = x, y = y, fill = elevation)) +
  scale_fill_viridis_c(option = "B") +
  theme_void() +
  coord_equal() +
  labs(title = "Gran Sasso Elevation (10-minute map)",
       caption = "Data source: elevatr / USGS")
```



## option 2

```{r}
library(terra)
library(ggplot2)
library(sf)
library(geodata)
library(stars)

# Download DEM
dem <- elevation_30s(country = "ITA", path = tempdir())

# Crop to Etna extent
etna <- ext(14.7, 15.25, 37.55, 37.9)
dem_etna <- crop(dem, etna)

# Create hillshade
slope  <- terrain(dem_etna, v = "slope",  unit = "radians")
aspect <- terrain(dem_etna, v = "aspect", unit = "radians")
hill   <- shade(slope, aspect, angle = 40, direction = 300)

hill_st <- st_as_stars(hill)

ggplot() +
  geom_stars(data = hill_st) +
  scale_fill_gradient(low = "black", high = "white", guide = "none") +
  coord_equal() +
  theme_void() +
  theme(
    plot.background = element_rect(fill = "black", color = "black"),
    panel.background = element_rect(fill = "black", color = "black")
  ) +
  labs(
    title = "Mount Etna — Hillshade",
    caption = "#30DayMapChallenge 2025 • Day 28: Black | Data: SRTM / geodata | Map: Federica Gazzelloni"
  )

```
