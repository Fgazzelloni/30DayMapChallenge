---
title: 'World'
subtitle: 'Welcome to #30DayMapChallenge 2025 day 18'
date: '2025-11-18'
image: 'day18_out_of_this_world.png'
image-alt: ''
description: ''
output: html_document
execute: 
   eval: false
---

##Climate Change â€“ Refrigerated Storage Costs


```{r}
library(tidyverse)
library(readxl)
library(osmdata)
library(sf)
```


```{r}
data_raw <- read_excel("data/09_2023-1_model-solution.xlsx")
head(data_raw)
```

```{r}
names(data_raw) <- data_raw[1,]
data <- data_raw[-1,]
```


```{r}
elev_data <- data %>%
  janitor::clean_names() %>%
  filter(check_versus_expected_range=="Ok",
         check_versus_expected_range_2=="Ok",
         check_versus_expected_range_3=="Ok") %>%
  select(latitude,longitude,elevation,country,continent)%>%
  drop_na() %>%
  mutate(latitude =as.numeric(latitude),
         longitude =as.numeric(longitude),
         elevation =as.numeric(elevation),
         country=str_to_title(country),
         continent=str_to_title(continent))

elev_data %>% 
  group_by(country)%>%
  count(sort = TRUE)
```


```{r}
world <- map_data("world")
```

```{r}
ggplot(elev_data)+
  geom_map(map = world,
           aes(map_id=country,
               fill= elevation))+
  expand_limits(x = world$long, y = world$lat)
```
```{r}
elev_data_sf <- elev_data %>%
  st_as_sf(coords = c("longitude","latitude"),crs=4326)
```

```{r}
crsuggest::suggest_crs(elev_data_sf)
```
```{r}
elev_data_sf_3832 <- elev_data_sf %>%
  st_transform(crs=3832)
```

```{r}
world <- rnaturalearth::ne_countries(returnclass = "sf",
                                     scale = "medium")%>%
  filter(!name=="Antarctica")
```


```{r}
ggplot(elev_data)+
  geom_sf(data = world, 
          aes(fill=name),
          alpha=0.5,
          show.legend = F,
          inherit.aes = F) +
  geom_point(aes(x=longitude,y=latitude,
                 color=elevation),
          size=0.9,shape=21,stroke=0.5,
          fill=alpha("black",0.5),
          show.legend = F)+
  scale_color_gradient(low="white",high="red")
```


